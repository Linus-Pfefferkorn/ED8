EDControl(EditForm:
  BorderIcons = set(SystemMenu),
  BorderStyle = Single,
  Caption = str('Edit routines'),
  Height = 486,
  Name = str('Advanced Linear Robot Edit Routines'),
  ShowHint = True,
  Top = 290,
  Visible = True,
  Width = 403,
  Controls(
    EDControl(MultiPage:
      ActivePage = 1,
      Align = Client,
      Anchors = set(Left,Top,Right,Bottom),
      Height = 446,
      Left = 0,
      Name = str('MultiPage1'),
      TabOrder = 1,
      Top = 0,
      Width = 403,
      Controls(
        EDControl(SinglePage:
          Caption = str('Define selection rules'),
          Name = str('SinglePage1'),
          PageIndex = 1,
          Controls(
            EDControl(GroupBox:
              Caption = str('Pick selection rule'),
              Height = 81,
              Left = 8,
              Name = str('gb_pickselectionrule'),
              TabOrder = 3,
              Top = 8,
              Width = 377),
            EDControl(GroupBox:
              Caption = str('Place selection rule'),
              Height = 73,
              Left = 8,
              Name = str('gb_placeselectionrule'),
              TabOrder = 4,
              Top = 88,
              Width = 377),
            EDControl(SmartEdit:
              Left = 20,
              Lines = str(''),
              Name = str('se_pickselectionrule'),
              String = str('{.~1|.}~1'),
              TabOrder = 1,
              Top = 41,
              Width = 353),
            EDControl(SmartEdit:
              Left = 20,
              Lines = str(''),
              Name = str('se_placeselectionrule'),
              String = str('{.~1|.}~1'),
              TabOrder = 2,
              Top = 113,
              Width = 353))),
        EDControl(SinglePage:
          Caption = str('Edit commands'),
          Name = str('SinglePage2'),
          PageIndex = 2,
          Controls(
            EDControl(Label:
              Caption = str('Deceleration [m/s²]:   (x)            (y)            (z)'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_deceleration'),
              Top = 232,
              Width = 207),
            EDControl(Label:
              Caption = str('Max. speed [m/s]:      (x)            (y)            (z)'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_maxspeed'),
              Top = 200,
              Width = 208),
            EDControl(Label:
              Caption = str('Acceleration [m/s²]:    (x)            (y)            (z)'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_acceleration'),
              Top = 168,
              Width = 209),
            EDControl(Button:
              Caption = str('Get position'),
              Left = 8,
              Name = str('bt_get_position'),
              TabOrder = 3,
              Top = 208,
              Width = 115,
              Events(
                Click = str('do('#13' {--Current position of Tool Base clarified by coordinate offset--}'#13' GuiControl([ef_x_destination],GuiSet([Text], String(xLoc(Rank(1,GuiAtom)) - Att([alr_world_x],GuiAtom)))),'#13' GuiControl([ef_y_destination],GuiSet([Text], String(yLoc(Rank(1,Rank(1,GuiAtom))) - Att([alr_world_y],GuiAtom)))),'#13' GuiControl([ef_z_destination],GuiSet([Text], String(zLoc(Rank(1,Rank(1,Rank(1,GuiAtom)))) - Att([alr_world_z],GuiAtom)))),'#13' {--Deflection of Tool Arm--}'#13' GuiControl([ef_deflection],GuiSet([Text], TextAtt([alr_tool_deflection],GuiAtom))), '#13' GuiControl([ef_deflectionspeed],GuiSet([Text], TextAtt([alr_tool_deflection_speed],GuiAtom))), '#13' {--Rotation of Tool Arm--}'#13' GuiControl([ef_rotation],GuiSet([Text], TextAtt([alr_tool_rotation],GuiAtom))), '#13' GuiControl([ef_rotationspeed],GuiSet([Text], TextAtt([alr_tool_rotation_speed],GuiAtom)))'#13')'#13))),
            EDControl(Button:
              Caption = str('Set position'),
              Left = 8,
              Name = str('bt_set_position'),
              TabOrder = 7,
              Top = 240,
              Width = 115,
              Events(
                Click = str('if('#13' '#13' {--Check destination parameters--}'#13' and('#13'  {--Destination (x) --}'#13'  if('#13'   or('#13'    {--Non visible parameter--}'#13'    not(GuiControl([ef_x_destination],GuiGet([Visible]))),'#13'    {--Destination (x) is a number--}'#13'    and('#13'     IsNumeric(GuiControl([ef_x_destination],GuiGet([Text]))),'#13'     1'#13'    )'#13'   ),'#13'   1,'#13'   do('#13'    Msg(concat([Destination (x) of Tool (m) must be a numeric value],lf,[Please change your entry]), 3), '#13'    return'#13'   )'#13'  ),'#13'  {--Destination (y) --}'#13'  if('#13'   or('#13'    {--Non visible parameter--}'#13'    not(GuiControl([ef_y_destination],GuiGet([Visible]))),'#13'    {--Destination (y) is a number--}'#13'    and('#13'     IsNumeric(GuiControl([ef_y_destination],GuiGet([Text]))),'#13'     1'#13'    )'#13'   ),'#13'   1,'#13'   do('#13'    Msg(concat([Destination (y) of Tool (m) must be a numeric value],lf,[Please change your entry]), 3), '#13'    return'#13'   )'#13'  ),'#13'  {--Destination (z) --}'#13'  if('#13'   or('#13'    {--Non visible parameter--}'#13'    not(GuiControl([ef_z_destination],GuiGet([Visible]))),'#13'    {--Destination (z) is a number--}'#13'    and('#13'     IsNumeric(GuiControl([ef_z_destination],GuiGet([Text]))),'#13'     1'#13'    )'#13'   ),'#13'   1,'#13'   do('#13'    Msg(concat([Destination (z) of Tool (m) must be a numeric value],lf,[Please change your entry]), 3), '#13'    return'#13'   )'#13'  ),'#13'  '#13'  {--Deflection--}'#13'  if('#13'   or('#13'    {--Non visible parameter--}'#13'    not(GuiControl([ef_deflection],GuiGet([Visible]))),'#13'    {--Declination is a number and between 105° and -105°--}'#13'    and('#13'     IsNumeric(GuiControl([ef_deflection],GuiGet([Text]))),'#13'     Value(GuiControl([ef_deflection],GuiGet([Text]))) > -105,'#13'     Value(GuiControl([ef_deflection],GuiGet([Text]))) < 105'#13'    )'#13'   ),'#13'   1,'#13'   do('#13'    Msg(concat([Deflection of Tool (°) must be a numeric value between -105° and 105°],lf,[Please change your entry]), 3), '#13'    return'#13'   )'#13'  ),'#13#13'  {--Deflection Speed--}'#13'  if('#13'   or('#13'    {--Non visible parameter--}'#13'    not(GuiControl([ef_deflectionspeed],GuiGet([Visible]))),'#13'    {--Declination is a number and > 0--}'#13'    and('#13'     IsNumeric(GuiControl([ef_deflectionspeed],GuiGet([Text]))),'#13'     Value(GuiControl([ef_deflectionspeed],GuiGet([Text]))) > 0'#13'    )'#13'   ),'#13'   1,'#13'   do('#13'    Msg(concat([Deflection speed of Tool (°/s) must be a numeric value between > 0],lf,[Please change your entry]), 3), '#13'    return'#13'   )'#13'  ),'#13'  '#13'  {--Rotation--}'#13'  if('#13'   or('#13'    {--Non visible parameter--}'#13'    not(GuiControl([ef_rotation],GuiGet([Visible]))),'#13'    {--Declination is a number and > 0--}'#13'    and('#13'     IsNumeric(GuiControl([ef_rotation],GuiGet([Text]))),'#13'     Value(GuiControl([ef_rotation],GuiGet([Text]))) > -360,'#13'     Value(GuiControl([ef_rotation],GuiGet([Text]))) < 360'#13'    )'#13'   ),'#13'   1,'#13'   do('#13'    Msg(concat([Rotation of Tool (°/s) must be a numeric value between -360° and 360°],lf,[Please change your entry]), 3), '#13'    return'#13'   )'#13'  ),'#13'  '#13'  {--Rotation speed--}'#13'  if('#13'   or('#13'    {--Non visible parameter--}'#13'    not(GuiControl([ef_rotationspeed],GuiGet([Visible]))),'#13'    {--Declination is a number and > 0--}'#13'    and('#13'     IsNumeric(GuiControl([ef_rotationspeed],GuiGet([Text]))),'#13'     Value(GuiControl([ef_rotationspeed],GuiGet([Text]))) > 0'#13'    )'#13'   ),'#13'   1,'#13'   do('#13'    Msg(concat([Rotation speed of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'    return'#13'   )'#13'  )'#13'  '#13' ),'#13#13' do('#13'  '#13'  {--Assigned deflection of Tool Arm--}'#13'  Att([alr_tool_deflection],GuiAtom) := Value(GuiControl([ef_deflection],GuiGet([Text]))),'#13'  '#13'  {--Assigned rotation of Tool Arm--}'#13'  Att([alr_tool_rotation],GuiAtom) := Value(GuiControl([ef_rotation],GuiGet([Text]))),'#13#13'  {--Assigned position of Slideway_X clarified by coordinate offset--}'#13'  SetLoc('#13'   Att([alr_world_x],GuiAtom) + Value(GuiControl([ef_x_destination],GuiGet([Text]))),'#13'   0,'#13'   0,'#13'   Rank(1,GuiAtom)'#13'  ),'#13'  '#13'  {--Assigned position of Slideway_Y clarified by coordinate offset--}'#13'  SetLoc('#13'   0,'#13'   Att([alr_world_y],GuiAtom) + Value(GuiControl([ef_y_destination],GuiGet([Text]))),'#13'   0,'#13'   Rank(1,Rank(1,GuiAtom))'#13'  ),'#13'  '#13'  {--Assigned position of Slideway_Z clarified by coordinate offset--}'#13'  SetLoc('#13'   0,'#13'   0,'#13'   Att([alr_world_z],GuiAtom) + Value(GuiControl([ef_z_destination],GuiGet([Text]))),'#13'   Rank(1,Rank(1,Rank(1,GuiAtom)))'#13'  )'#13' )'#13#13')'#13))),
            EDControl(Edit:
              Height = 21,
              Left = 264,
              Name = str('ef_rotationspeed'),
              TabOrder = 4,
              Text = str('ef_rotationspeed'),
              Top = 320),
            EDControl(Edit:
              Height = 21,
              Left = 264,
              Name = str('ef_rotation'),
              TabOrder = 5,
              Text = str('ef_rotation'),
              Top = 288),
            EDControl(Edit:
              Height = 21,
              Left = 264,
              Name = str('ef_deflectionspeed'),
              TabOrder = 6,
              Text = str('ef_deflectionspeed'),
              Top = 384,
              Visible = False),
            EDControl(Edit:
              Height = 21,
              Left = 264,
              Name = str('ef_deflection'),
              TabOrder = 12,
              Text = str('ef_deflection'),
              Top = 352,
              Visible = False),
            EDControl(Edit:
              Height = 21,
              Left = 264,
              Name = str('ef_endspeed'),
              TabOrder = 8,
              Text = str('ef_endspeed'),
              Top = 256),
            EDControl(Edit:
              Height = 21,
              Left = 256,
              Name = str('ef_x_deceleration'),
              TabOrder = 10,
              Text = str('ef_x_deceleration'),
              Top = 224,
              Width = 33),
            EDControl(Edit:
              Height = 21,
              Left = 256,
              Name = str('ef_x_maxspeed'),
              TabOrder = 11,
              Text = str('ef_x_maxspeed'),
              Top = 192,
              Width = 33),
            EDControl(Edit:
              Height = 21,
              Left = 256,
              Name = str('ef_x_acceleration'),
              TabOrder = 13,
              Text = str('ef_acceleration'),
              Top = 160,
              Width = 33),
            EDControl(Edit:
              Height = 21,
              Left = 264,
              Name = str('ef_z_destination'),
              TabOrder = 14,
              Text = str('ef_z_destination'),
              Top = 128),
            EDControl(Edit:
              Height = 21,
              Left = 264,
              Name = str('ef_channel'),
              TabOrder = 17,
              Text = str('ef_channel'),
              Top = 96),
            EDControl(SyntaxComboBox:
              Height = 24,
              Left = 264,
              Name = str('ef_trigger'),
              TabOrder = 16,
              Top = 64,
              Width = 121),
            EDControl(Edit:
              Height = 21,
              Left = 264,
              Name = str('ef_comment'),
              TabOrder = 15,
              Text = str('ef_comment'),
              Top = 32),
            EDControl(Label:
              Caption = str('Command text'),
              Color = -16777208,
              Height = 13,
              Left = 300,
              Name = str('st_command_text'),
              Top = 8,
              Width = 67),
            EDControl(Label:
              Caption = str('Selected command:'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_command'),
              Top = 8,
              Width = 94),
            EDControl(Label:
              Caption = str('Comment [string]:'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_comment'),
              Top = 40,
              Width = 81),
            EDControl(Label:
              Caption = str('Trigger [4DScript]:'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_trigger'),
              Top = 72,
              Width = 86),
            EDControl(Label:
              Caption = str('Channel [index]:'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_channel'),
              Top = 104,
              Width = 76),
            EDControl(Label:
              Caption = str('Destination (z):'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_z_destination'),
              Top = 136,
              Width = 70),
            EDControl(Label:
              Caption = str('End speed (xyz) [m/s]:'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_endspeed'),
              Top = 264,
              Width = 105),
            EDControl(Label:
              Caption = str('Tool arm deflection [°]:'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_deflection'),
              Top = 360,
              Visible = False,
              Width = 106),
            EDControl(Label:
              Caption = str('Deflection speed [°/s]:'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_deflectionspeed'),
              Top = 392,
              Visible = False,
              Width = 106),
            EDControl(Label:
              Caption = str('Tool rotation [°]:'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_rotation'),
              Top = 296,
              Width = 75),
            EDControl(Label:
              Caption = str('Rotation speed [°/s]:'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_rotationspeed'),
              Top = 328,
              Width = 98),
            EDControl(Button:
              Caption = str('Delete command'),
              Left = 8,
              Name = str('bt_delete_command'),
              TabOrder = 18,
              Top = 368,
              Width = 115,
              Events(
                Click = str('do('#13' var([routine_atom], vbAtom),'#13' var([routine_row], vbValue),'#13#13' if('#13'  {--Fail safe--}'#13'  and('#13'   Att([alr_active_routine],GuiAtom) > 0,'#13'   AtomExists(vtp(Att([alr_active_routine],GuiAtom)), Rank(2,GuiAtom))'#13'  ),'#13'  {---Delete command of selected routine--}'#13'  do('#13'   routine_atom := vtp(Att([alr_active_routine], GuiAtom)),'#13'   routine_row := InputNum(Max(1,nRows(routine_atom) - 1), [Select row index], 1, nRows(routine_atom), 0),'#13'   '#13'   if('#13'    {--No CANCEL or zero--}'#13'    routine_row > 0,'#13'    if('#13'     or('#13'      {--Not last row of table--}'#13'      routine_row < nRows(routine_atom),'#13'      and('#13'       {--Last row of table,--}'#13'       routine_row = nRows(routine_atom),'#13'       {--But not row number 1--}'#13'       nRows(routine_atom) > 1'#13'      )'#13'     ),'#13'     do('#13'      {--Delete row of command--}'#13'      DeleteRow(routine_row, routine_atom),'#13'      {--Update index--}'#13'      Repeat(nRows(routine_atom),'#13'       Cell(Count, 0, routine_atom) := Count'#13'      )'#13'     ),'#13'     {--Last row--}'#13'     if('#13'     {--Delete routine--}'#13'      Confirm(Concat([Delete ],Name(routine_atom),[?])),'#13'      do('#13'       Att([alr_active_routine],GuiAtom) := 0,'#13'       Close(TableWindow(routine_atom)),'#13'       DestroyAtom(routine_atom),'#13'       if('#13'        {--Select new routine--}'#13'        Confirm(Concat([No routine currently selected.], CR, [Select routine to continue?])),'#13'        do('#13'         GuiSelect([Advanced Linear Robot Add Command], [bt_select_routine]),'#13'         GuiRun([Click])'#13'        )'#13'       )'#13'      )'#13'     )'#13'    )'#13'   )'#13'  ),'#13' '#13'  {--Select routine first--}'#13'  do('#13'   msg(Concat([No routine currently selected.], CR, [Select routine first.])),'#13'   GuiSelect([Advanced Linear Robot Add Command], [bt_select_routine]),'#13'   GuiRun([Click])'#13'  )'#13' '#13' )'#13' '#13')'#13))),
            EDControl(Button:
              Caption = str('Copy command'),
              Left = 8,
              Name = str('bt_copy_command'),
              TabOrder = 19,
              Top = 336,
              Width = 115,
              Events(
                Click = str('do('#13' var([routine_atom], vbAtom),'#13' var([routine_row1], vbValue),'#13' var([routine_row2], vbValue),'#13#13' if('#13'  {--Fail safe--}'#13'  and('#13'   Att([alr_active_routine],GuiAtom) > 0,'#13'   AtomExists(vtp(Att([alr_active_routine],GuiAtom)), Rank(2,GuiAtom))'#13'  ),'#13'  {---Apply command to selected routine--}'#13'  do('#13'   routine_atom := vtp(Att([alr_active_routine],GuiAtom)),'#13'   routine_row1 := InputNum(Max(1,nRows(routine_atom) - 1),[Select row index of template], 1, nRows(routine_atom), 0),'#13'   routine_row2 := InputNum(nRows(routine_atom),[Select row index to copy to], 1, nRows(routine_atom), 0),'#13'   '#13'   if('#13'    {--Rows of template and copy are within table limits--}'#13'    and('#13'     routine_row1 > 0,'#13'     routine_row1 <= nRows(routine_atom),'#13'     routine_row2 > 0,'#13'     routine_row2 <= nRows(routine_atom)'#13'    ),'#13'    do('#13'     {--New row for new command--}'#13'     InsertRow(routine_row2,routine_atom),'#13'     '#13'     {--Insert row displaced template downward--}'#13'     if(routine_row1 >= routine_row2,'#13'      Inc(routine_row1)'#13'     ),'#13'    '#13'     {--Copy parameters to table (all)--}'#13'     Repeat(nCols(routine_atom),'#13'      Cell(routine_row2,Count,routine_atom) :=  Cell(routine_row1,Count,routine_atom)'#13'     ),'#13#13'     {--Update index--}'#13'     Repeat(nRows(routine_atom),'#13'      Cell(Count,0,routine_atom) := Count'#13'     )'#13'    )'#13'   )'#13'  ),'#13' '#13'  {--Select routine first--}'#13'  do('#13'   msg(Concat([No routine currently selected.],CR,[Select routine first.])),'#13'   GuiSelect([Advanced Linear Robot Add Command],[bt_select_routine]),'#13'   GuiRun([Click])'#13'  )'#13' '#13' )'#13' '#13')'#13))),
            EDControl(Button:
              Caption = str('Insert command'),
              Left = 8,
              Name = str('bt_insert_command'),
              TabOrder = 20,
              Top = 304,
              Width = 115,
              Events(
                Click = str('do('#13' var([routine_atom], vbAtom),'#13' var([routine_row], vbValue),'#13#13' if('#13'  {--Fail safe--}'#13'  and('#13'   Att([alr_active_routine],GuiAtom) > 0,'#13'   AtomExists(vtp(Att([alr_active_routine],GuiAtom)), Rank(2,GuiAtom))'#13'  ),'#13'  '#13'  if('#13'   and('#13#13'    {--Check parameters--}'#13#13'    {--Destination (x) --}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_x_destination],GuiGet([Visible]))),'#13'      {--Destination (x) is a number--}'#13'      and('#13'       IsNumeric(GuiControl([ef_x_destination],GuiGet([Text]))),'#13'       1'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Destination (x) of Tool (m) must be a numeric value],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Destination (y) --}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_y_destination],GuiGet([Visible]))),'#13'      {--Destination (y) is a number--}'#13'      and('#13'       IsNumeric(GuiControl([ef_y_destination],GuiGet([Text]))),'#13'       1'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Destination (y) of Tool (m) must be a numeric value],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Destination (z) --}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_z_destination],GuiGet([Visible]))),'#13'      {--Destination (z) is a number--}'#13'      and('#13'       IsNumeric(GuiControl([ef_z_destination],GuiGet([Text]))),'#13'       1'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Destination (z) of Tool (m) must be a numeric value],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Acceleration (x)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_x_acceleration],GuiGet([Visible]))),'#13'      {--Acceleration is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_x_acceleration],GuiGet([Text]))),'#13'       Value(GuiControl([ef_x_acceleration],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Acceleration (x) of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Acceleration (y)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_y_acceleration],GuiGet([Visible]))),'#13'      {--Acceleration is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_y_acceleration],GuiGet([Text]))),'#13'       Value(GuiControl([ef_y_acceleration],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Acceleration (y) of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Acceleration (z)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_z_acceleration],GuiGet([Visible]))),'#13'      {--Acceleration is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_z_acceleration],GuiGet([Text]))),'#13'       Value(GuiControl([ef_z_acceleration],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Acceleration (z) of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Maxspeed (x)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_x_maxspeed],GuiGet([Visible]))),'#13'      {--Maxspeed is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_x_maxspeed],GuiGet([Text]))),'#13'       Value(GuiControl([ef_x_maxspeed],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Maximum speed (x) of Tool (m/s) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Maxspeed (y)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_y_maxspeed],GuiGet([Visible]))),'#13'      {--Maxspeed is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_y_maxspeed],GuiGet([Text]))),'#13'       Value(GuiControl([ef_y_maxspeed],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Maximum speed (y) of Tool (m/s) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Maxspeed (z)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_z_maxspeed],GuiGet([Visible]))),'#13'      {--Maxspeed is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_z_maxspeed],GuiGet([Text]))),'#13'       Value(GuiControl([ef_z_maxspeed],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Maximum speed (z) of Tool (m/s) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Deceleration (x)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_x_deceleration],GuiGet([Visible]))),'#13'      {--Deceleration is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_x_deceleration],GuiGet([Text]))),'#13'       Value(GuiControl([ef_x_deceleration],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Deceleration (x) of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Deceleration (y)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_y_deceleration],GuiGet([Visible]))),'#13'      {--Deceleration is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_y_deceleration],GuiGet([Text]))),'#13'       Value(GuiControl([ef_y_deceleration],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Deceleration (y) of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Deceleration (z)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_z_deceleration],GuiGet([Visible]))),'#13'      {--Deceleration is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_z_deceleration],GuiGet([Text]))),'#13'       Value(GuiControl([ef_z_deceleration],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Deceleration (z) of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'     ),'#13'    {--Endspeed --}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_endspeed],GuiGet([Visible]))),'#13'      {--Endspeed is a number and >= 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_endspeed],GuiGet([Text]))),'#13'       Value(GuiControl([ef_endspeed],GuiGet([Text]))) >= 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([End speed of Tool (m/s) must be a numeric value >= 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Time --}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_time],GuiGet([Visible]))),'#13'      {--Time is a number and >= 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_time],GuiGet([Text]))),'#13'       Value(GuiControl([ef_time],GuiGet([Text]))) >= 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Time (s) must be a numeric value >= 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Channel --}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_channel],GuiGet([Visible]))),'#13'      {--Channel is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_channel],GuiGet([Text]))),'#13'       Value(GuiControl([ef_channel],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Channel must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Message--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_getmessage],GuiGet([Visible]))),'#13'      {--Message is longer than 1 character--}'#13'      and('#13'       StringLength(GuiControl([ef_getmessage],GuiGet([Text]))) > 0,'#13'       1'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Awaited message must be a string with more than 1 character],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Trigger --}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_trigger],GuiGet([Visible]))),'#13'      {--Trigger is a valid expression--}'#13'      and('#13'       CheckSyntax(GuiControl([ef_trigger],GuiGet([Text]))),'#13'       1'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Trigger must be a valid expression],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    '#13'    {--Deflection--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_deflection],GuiGet([Visible]))),'#13'      {--Declination is a number and between 105° and -105°--}'#13'      and('#13'       IsNumeric(GuiControl([ef_deflection],GuiGet([Text]))),'#13'       Value(GuiControl([ef_deflection],GuiGet([Text]))) > -105,'#13'       Value(GuiControl([ef_deflection],GuiGet([Text]))) < 105'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Deflection of Tool (°) must be a numeric value between -105° and 105°],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13#13'    {--Deflection Speed--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_deflectionspeed],GuiGet([Visible]))),'#13'      {--Declination is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_deflectionspeed],GuiGet([Text]))),'#13'       Value(GuiControl([ef_deflectionspeed],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Deflection speed of Tool (°/s) must be a numeric value between > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    '#13'    {--Rotation--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_rotation],GuiGet([Visible]))),'#13'      {--Declination is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_rotation],GuiGet([Text]))),'#13'       Value(GuiControl([ef_rotation],GuiGet([Text]))) > -360,'#13'       Value(GuiControl([ef_rotation],GuiGet([Text]))) < 360'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Rotation of Tool (°/s) must be a numeric value between -360° and 360°],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    '#13'    {--Rotation speed--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_rotationspeed],GuiGet([Visible]))),'#13'      {--Declination is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_rotationspeed],GuiGet([Text]))),'#13'       Value(GuiControl([ef_rotationspeed],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Rotation speed of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    )'#13'   ), '#13#13'   {---Apply command to selected routine--}'#13'   do('#13'    routine_atom := vtp(Att([alr_active_routine],GuiAtom)),'#13'    routine_row := InputNum(nRows(routine_atom),[Select row index], 1, nRows(routine_atom), 0),'#13'    '#13'    if('#13'     {--Row is within table limits--}'#13'     and('#13'      routine_row > 0,'#13'      routine_row <= nRows(routine_atom)'#13'     ),     '#13'     do('#13'      {--New row for new command--}'#13'      InsertRow(routine_row,routine_atom),'#13'     '#13'      {--Write parameters to table (visible only)--}'#13'  '#13'      {--Command text--}'#13'      Cell(routine_row,1,routine_atom) :=  GuiControl([st_command_text],GuiGet([Caption])),'#13'      {--Command index--}'#13'      Cell(routine_row,2,routine_atom) :=  GuiControl([rg_select_command], GuiGet([ItemIndex])),'#13'      {--Comment--}'#13'      Cell(routine_row,3,routine_atom) :=  if( GuiControl([ef_comment],GuiGet([Visible])),         GuiControl([ef_comment],GuiGet([Text])),         [        --] ),'#13'      {--Destination (x)--}'#13'      Cell(routine_row,4,routine_atom) :=  if( GuiControl([ef_x_destination],GuiGet([Visible])),   GuiControl([ef_x_destination],GuiGet([Text])),   [        --] ),'#13'      {--Destination (y)--}'#13'      Cell(routine_row,5,routine_atom) :=  if( GuiControl([ef_y_destination],GuiGet([Visible])),   GuiControl([ef_y_destination],GuiGet([Text])),   [        --] ),'#13'      {--Destination (z)--}'#13'      Cell(routine_row,6,routine_atom) :=  if( GuiControl([ef_z_destination],GuiGet([Visible])),   GuiControl([ef_z_destination],GuiGet([Text])),   [        --] ),'#13'      {--Acceleration--}'#13'      Cell(routine_row,7,routine_atom) :=  if( GuiControl([ef_x_acceleration],GuiGet([Visible])),    GuiControl([ef_x_acceleration],GuiGet([Text])),    [        --] ),'#13'      Cell(routine_row,8,routine_atom) :=  if( GuiControl([ef_y_acceleration],GuiGet([Visible])),    GuiControl([ef_y_acceleration],GuiGet([Text])),    [        --] ),'#13'      Cell(routine_row,9,routine_atom) :=  if( GuiControl([ef_z_acceleration],GuiGet([Visible])),    GuiControl([ef_z_acceleration],GuiGet([Text])),    [        --] ),'#13'      {--Maxspeed--}'#13'      Cell(routine_row,10,routine_atom) :=  if( GuiControl([ef_x_maxspeed],GuiGet([Visible])),        GuiControl([ef_x_maxspeed],GuiGet([Text])),        [        --] ),'#13'      Cell(routine_row,11,routine_atom) :=  if( GuiControl([ef_y_maxspeed],GuiGet([Visible])),        GuiControl([ef_y_maxspeed],GuiGet([Text])),        [        --] ),'#13'      Cell(routine_row,12,routine_atom) :=  if( GuiControl([ef_z_maxspeed],GuiGet([Visible])),        GuiControl([ef_z_maxspeed],GuiGet([Text])),        [        --] ),'#13'      {--Deceleration--}'#13'      Cell(routine_row,13,routine_atom) :=  if( GuiControl([ef_x_deceleration],GuiGet([Visible])),    GuiControl([ef_x_deceleration],GuiGet([Text])),    [        --] ),'#13'      Cell(routine_row,14,routine_atom) :=  if( GuiControl([ef_y_deceleration],GuiGet([Visible])),    GuiControl([ef_y_deceleration],GuiGet([Text])),    [        --] ),'#13'      Cell(routine_row,15,routine_atom) :=  if( GuiControl([ef_z_deceleration],GuiGet([Visible])),    GuiControl([ef_z_deceleration],GuiGet([Text])),    [        --] ),'#13'      {--Endspeed--}'#13'      Cell(routine_row,16,routine_atom) := if( GuiControl([ef_endspeed],GuiGet([Visible])),        GuiControl([ef_endspeed],GuiGet([Text])),        [        --] ),'#13'      {--Time--}'#13'      Cell(routine_row,17,routine_atom) := if( GuiControl([ef_time],GuiGet([Visible])),            GuiControl([ef_time],GuiGet([Text])),            [        --] ),'#13'      {--Channel--}'#13'      Cell(routine_row,18,routine_atom) := if( GuiControl([ef_channel],GuiGet([Visible])),         GuiControl([ef_channel],GuiGet([Text])),         [        --] ),'#13'      {--Not used parameter--}'#13'      Cell(routine_row,19,routine_atom) := [        --],'#13'      {--Atom--}'#13'      Cell(routine_row,20,routine_atom) := if( GuiControl([ef_getmessage],GuiGet([Visible])),      GuiControl([ef_getmessage],GuiGet([Text])),      [        --] ),'#13'      {--Trigger--}'#13'      Cell(routine_row,21,routine_atom) := if( GuiControl([ef_trigger],GuiGet([Visible])),         GuiControl([ef_trigger],GuiGet([ResultCode])),   [        --] ),'#13'      {--Deflection--}'#13'      Cell(routine_row,22,routine_atom) := if( GuiControl([ef_deflection],GuiGet([Visible])),      GuiControl([ef_deflection],GuiGet([Text])),      [        --] ),'#13'      {--Deflection speed--}'#13'      Cell(routine_row,23,routine_atom) := if( GuiControl([ef_deflectionspeed],GuiGet([Visible])), GuiControl([ef_deflectionspeed],GuiGet([Text])), [        --] ),'#13'      {--Rotation--}'#13'      Cell(routine_row,24,routine_atom) := if( GuiControl([ef_rotation],GuiGet([Visible])),        GuiControl([ef_rotation],GuiGet([Text])),        [        --] ),'#13'      {--Rotation speed--}'#13'      Cell(routine_row,25,routine_atom) := if( GuiControl([ef_rotationspeed],GuiGet([Visible])),   GuiControl([ef_rotationspeed],GuiGet([Text])),   [        --] ),'#13'         '#13'      {--Write parameters to temporary attributes (visible only)--}'#13'      '#13'      Att([alr_routine_command],GuiAtom) :=                GuiControl([st_command_text],GuiGet([Caption])),'#13'      if( GuiControl([ef_comment],GuiGet([Visible])),       Att([alr_routine_comment],GuiAtom) :=       GuiControl([ef_comment],GuiGet([Text])) ),'#13'      if( GuiControl([ef_x_destination],GuiGet([Visible])), Att([alr_routine_x_destination],GuiAtom) := GuiControl([ef_x_destination],GuiGet([Text])) ),'#13'      if( GuiControl([ef_y_destination],GuiGet([Visible])), Att([alr_routine_y_destination],GuiAtom) := GuiControl([ef_y_destination],GuiGet([Text])) ),'#13'      if( GuiControl([ef_z_destination],GuiGet([Visible])), Att([alr_routine_z_destination],GuiAtom) := GuiControl([ef_z_destination],GuiGet([Text])) ),'#13'      if( GuiControl([ef_x_acceleration],GuiGet([Visible])),  Att([alr_routine_x_acceleration],GuiAtom) :=  GuiControl([ef_x_acceleration],GuiGet([Text])) ),'#13'      if( GuiControl([ef_y_acceleration],GuiGet([Visible])),  Att([alr_routine_y_acceleration],GuiAtom) :=  GuiControl([ef_y_acceleration],GuiGet([Text])) ),'#13'      if( GuiControl([ef_z_acceleration],GuiGet([Visible])),  Att([alr_routine_z_acceleration],GuiAtom) :=  GuiControl([ef_z_acceleration],GuiGet([Text])) ),'#13'      if( GuiControl([ef_x_maxspeed],GuiGet([Visible])),      Att([alr_routine_x_maxspeed],GuiAtom) :=      GuiControl([ef_x_maxspeed],GuiGet([Text])) ),'#13'      if( GuiControl([ef_y_maxspeed],GuiGet([Visible])),      Att([alr_routine_y_maxspeed],GuiAtom) :=      GuiControl([ef_y_maxspeed],GuiGet([Text])) ),'#13'      if( GuiControl([ef_z_maxspeed],GuiGet([Visible])),      Att([alr_routine_z_maxspeed],GuiAtom) :=      GuiControl([ef_z_maxspeed],GuiGet([Text])) ),'#13'      if( GuiControl([ef_x_deceleration],GuiGet([Visible])),  Att([alr_routine_x_deceleration],GuiAtom) :=  GuiControl([ef_x_deceleration],GuiGet([Text])) ),'#13'      if( GuiControl([ef_y_deceleration],GuiGet([Visible])),  Att([alr_routine_y_deceleration],GuiAtom) :=  GuiControl([ef_y_deceleration],GuiGet([Text])) ),'#13'      if( GuiControl([ef_z_deceleration],GuiGet([Visible])),  Att([alr_routine_z_deceleration],GuiAtom) :=  GuiControl([ef_z_deceleration],GuiGet([Text])) ),'#13'      if( GuiControl([ef_endspeed],GuiGet([Visible])),      Att([alr_routine_endspeed],GuiAtom) :=      GuiControl([ef_endspeed],GuiGet([Text])) ),'#13'      if( GuiControl([ef_time],GuiGet([Visible])),          Att([alr_routine_time],GuiAtom) :=          GuiControl([ef_time],GuiGet([Text])) ),'#13'      if( GuiControl([ef_channel],GuiGet([Visible])),       Att([alr_routine_channel],GuiAtom) :=       GuiControl([ef_channel],GuiGet([Text])) ),'#13'      if( GuiControl([ef_getmessage],GuiGet([Visible])),    Att([alr_routine_getmessage],GuiAtom) :=    GuiControl([ef_getmessage],GuiGet([Text])) ),'#13'      if( GuiControl([ef_trigger],GuiGet([Visible])),       Att([alr_routine_trigger],GuiAtom) :=       GuiControl([ef_trigger],GuiGet([ResultCode])) ),'#13'      if( GuiControl([ef_deflection],GuiGet([Visible])),       Att([alr_routine_tool_deflection],GuiAtom) :=       GuiControl([ef_deflection],GuiGet([Text])) ),'#13'      if( GuiControl([ef_deflectionspeed],GuiGet([Visible])),  Att([alr_routine_tool_deflection_speed],GuiAtom) := GuiControl([ef_deflectionspeed],GuiGet([Text])) ),'#13'      if( GuiControl([ef_rotation],GuiGet([Visible])),         Att([alr_routine_tool_rotation],GuiAtom) :=         GuiControl([ef_rotation],GuiGet([Text])) ),'#13'      if( GuiControl([ef_rotationspeed],GuiGet([Visible])),    Att([alr_routine_tool_rotation_speed],GuiAtom) :=   GuiControl([ef_rotationspeed],GuiGet([Text])) ),'#13#13'      {--Update index--}'#13'      Repeat(nRows(routine_atom),'#13'       Cell(Count,0,routine_atom) := Count'#13'      )'#13'     )'#13'    )'#13'   )'#13'  ),'#13'  {--Select routine first--}'#13'  do('#13'   msg(Concat([No routine currently selected.],CR,[Select routine first.])),'#13'   GuiSelect([Advanced Linear Robot Add Command],[bt_select_routine]),'#13'   GuiRun([Click])'#13'  )'#13' )'#13' '#13')'#13))),
            EDControl(Button:
              Caption = str('Apply command'),
              Left = 8,
              Name = str('bt_apply_command'),
              TabOrder = 21,
              Top = 272,
              Width = 115,
              Events(
                Click = str('do('#13' var([routine_atom], vbAtom),'#13' var([routine_row], vbValue),'#13#13' if('#13'  {--Fail safe--}'#13'  and('#13'   {--Pointer of active routine--}'#13'   Att([alr_active_routine],GuiAtom) > 0,'#13'   {--Routine exists--}'#13'   AtomExists(vtp(Att([alr_active_routine],GuiAtom)), Rank(2,GuiAtom))'#13'  ),'#13'  if('#13'   and(      '#13'   '#13'    {--Check parameters--}'#13'    '#13'    {--Destination (x) --}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_x_destination],GuiGet([Visible]))),'#13'      {--Destination (x) is a number--}'#13'      and('#13'       IsNumeric(GuiControl([ef_x_destination],GuiGet([Text]))),'#13'       1'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Destination (x) of Tool (m) must be a numeric value],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Destination (y) --}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_y_destination],GuiGet([Visible]))),'#13'      {--Destination (y) is a number--}'#13'      and('#13'       IsNumeric(GuiControl([ef_y_destination],GuiGet([Text]))),'#13'       1'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Destination (y) of Tool (m) must be a numeric value],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Destination (z) --}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_z_destination],GuiGet([Visible]))),'#13'      {--Destination (z) is a number--}'#13'      and('#13'       IsNumeric(GuiControl([ef_z_destination],GuiGet([Text]))),'#13'       1'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Destination (z) of Tool (m) must be a numeric value],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Acceleration (x)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_x_acceleration],GuiGet([Visible]))),'#13'      {--Acceleration is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_x_acceleration],GuiGet([Text]))),'#13'       Value(GuiControl([ef_x_acceleration],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Acceleration (x) of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Acceleration (y)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_y_acceleration],GuiGet([Visible]))),'#13'      {--Acceleration is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_y_acceleration],GuiGet([Text]))),'#13'       Value(GuiControl([ef_y_acceleration],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Acceleration (y) of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Acceleration (z)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_z_acceleration],GuiGet([Visible]))),'#13'      {--Acceleration is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_z_acceleration],GuiGet([Text]))),'#13'       Value(GuiControl([ef_z_acceleration],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Acceleration (z) of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Maxspeed (x)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_x_maxspeed],GuiGet([Visible]))),'#13'      {--Maxspeed is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_x_maxspeed],GuiGet([Text]))),'#13'       Value(GuiControl([ef_x_maxspeed],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Maximum speed (x) of Tool (m/s) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Maxspeed (y)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_y_maxspeed],GuiGet([Visible]))),'#13'      {--Maxspeed is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_y_maxspeed],GuiGet([Text]))),'#13'       Value(GuiControl([ef_y_maxspeed],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Maximum speed (y) of Tool (m/s) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Maxspeed (z)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_z_maxspeed],GuiGet([Visible]))),'#13'      {--Maxspeed is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_z_maxspeed],GuiGet([Text]))),'#13'       Value(GuiControl([ef_z_maxspeed],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Maximum speed (z) of Tool (m/s) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Deceleration (x)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_x_deceleration],GuiGet([Visible]))),'#13'      {--Deceleration is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_x_deceleration],GuiGet([Text]))),'#13'       Value(GuiControl([ef_x_deceleration],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Deceleration (x) of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Deceleration (y)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_y_deceleration],GuiGet([Visible]))),'#13'      {--Deceleration is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_y_deceleration],GuiGet([Text]))),'#13'       Value(GuiControl([ef_y_deceleration],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Deceleration (y) of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Deceleration (z)--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_z_deceleration],GuiGet([Visible]))),'#13'      {--Deceleration is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_z_deceleration],GuiGet([Text]))),'#13'       Value(GuiControl([ef_z_deceleration],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Deceleration (z) of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Endspeed--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_endspeed],GuiGet([Visible]))),'#13'      {--Endspeed is a number and >= 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_endspeed],GuiGet([Text]))),'#13'       Value(GuiControl([ef_endspeed],GuiGet([Text]))) >= 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([End speed of Tool (m/s) must be a numeric value >= 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Time--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_time],GuiGet([Visible]))),'#13'      {--Time is a number and >= 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_time],GuiGet([Text]))),'#13'       Value(GuiControl([ef_time],GuiGet([Text]))) >= 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Time (s) must be a numeric value >= 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Channel--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_channel],GuiGet([Visible]))),'#13'      {--Channel is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_channel],GuiGet([Text]))),'#13'       Value(GuiControl([ef_channel],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Channel must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Message--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_getmessage],GuiGet([Visible]))),'#13'      {--Message is longer than 1 character--}'#13'      and('#13'       StringLength(GuiControl([ef_getmessage],GuiGet([Text]))) > 0,'#13'       1'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Awaited message must be a string with more than 1 character],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    {--Trigger--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_trigger],GuiGet([Visible]))),'#13'      {--Trigger is a valid expression--}'#13'      and('#13'       CheckSyntax(GuiControl([ef_trigger],GuiGet([Text]))),'#13'       1'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Trigger must be a valid 4D Script expression],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    '#13'    {--Deflection--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_deflection],GuiGet([Visible]))),'#13'      {--Declination is a number and between 105° and -105°--}'#13'      and('#13'       IsNumeric(GuiControl([ef_deflection],GuiGet([Text]))),'#13'       Value(GuiControl([ef_deflection],GuiGet([Text]))) > -105,'#13'       Value(GuiControl([ef_deflection],GuiGet([Text]))) < 105'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Deflection of Tool (°) must be a numeric value between -105° and 105°],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13#13'    {--Deflection Speed--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_deflectionspeed],GuiGet([Visible]))),'#13'      {--Declination is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_deflectionspeed],GuiGet([Text]))),'#13'       Value(GuiControl([ef_deflectionspeed],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Deflection speed of Tool (°/s) must be a numeric value between > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    '#13'    {--Rotation--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_rotation],GuiGet([Visible]))),'#13'      {--Declination is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_rotation],GuiGet([Text]))),'#13'       Value(GuiControl([ef_rotation],GuiGet([Text]))) > -360,'#13'       Value(GuiControl([ef_rotation],GuiGet([Text]))) < 360'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Rotation of Tool (°/s) must be a numeric value between -360° and 360°],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    ),'#13'    '#13'    {--Rotation speed--}'#13'    if('#13'     or('#13'      {--Non visible parameter--}'#13'      not(GuiControl([ef_rotationspeed],GuiGet([Visible]))),'#13'      {--Declination is a number and > 0--}'#13'      and('#13'       IsNumeric(GuiControl([ef_rotationspeed],GuiGet([Text]))),'#13'       Value(GuiControl([ef_rotationspeed],GuiGet([Text]))) > 0'#13'      )'#13'     ),'#13'     1,'#13'     do('#13'      Msg(concat([Rotation speed of Tool (m/s²) must be a numeric value > 0],lf,[Please change your entry]), 3), '#13'      return'#13'     )'#13'    )'#13'        '#13'   ), '#13'  '#13'   {---Apply command to selected routine--}'#13'   do('#13'    routine_atom := vtp(Att([alr_active_routine],GuiAtom)),'#13'    routine_row := if(nRows(routine_atom),1,nRows(routine_atom)),'#13'    '#13'    {--New row for new command--}'#13'    InsertRow(routine_row,routine_atom),'#13'   '#13'    {--Write parameters to table (visible only)--}'#13#13'    {--Command text--}'#13'    Cell(routine_row,1,routine_atom) :=  GuiControl([st_command_text],GuiGet([Caption])),'#13'    {--Command index--}'#13'    Cell(routine_row,2,routine_atom) :=  GuiControl([rg_select_command], GuiGet([ItemIndex])),'#13'    {--Comment--}'#13'    Cell(routine_row,3,routine_atom) :=  if( GuiControl([ef_comment],GuiGet([Visible])),         GuiControl([ef_comment],GuiGet([Text])),         [        --] ),'#13'    {--Destination (x)--}'#13'    Cell(routine_row,4,routine_atom) :=  if( GuiControl([ef_x_destination],GuiGet([Visible])),   GuiControl([ef_x_destination],GuiGet([Text])),   [        --] ),'#13'    {--Destination (y)--}'#13'    Cell(routine_row,5,routine_atom) :=  if( GuiControl([ef_y_destination],GuiGet([Visible])),   GuiControl([ef_y_destination],GuiGet([Text])),   [        --] ),'#13'    {--Destination (z)--}'#13'    Cell(routine_row,6,routine_atom) :=  if( GuiControl([ef_z_destination],GuiGet([Visible])),   GuiControl([ef_z_destination],GuiGet([Text])),   [        --] ),'#13'    {--Acceleration--}'#13'    Cell(routine_row,7,routine_atom) :=  if( GuiControl([ef_x_acceleration],GuiGet([Visible])),    GuiControl([ef_x_acceleration],GuiGet([Text])),    [        --] ),'#13'    Cell(routine_row,8,routine_atom) :=  if( GuiControl([ef_y_acceleration],GuiGet([Visible])),    GuiControl([ef_y_acceleration],GuiGet([Text])),    [        --] ),'#13'    Cell(routine_row,9,routine_atom) :=  if( GuiControl([ef_z_acceleration],GuiGet([Visible])),    GuiControl([ef_z_acceleration],GuiGet([Text])),    [        --] ),'#13'    {--Maxspeed--}'#13'    Cell(routine_row,10,routine_atom) :=  if( GuiControl([ef_x_maxspeed],GuiGet([Visible])),        GuiControl([ef_x_maxspeed],GuiGet([Text])),        [        --] ),'#13'    Cell(routine_row,11,routine_atom) :=  if( GuiControl([ef_y_maxspeed],GuiGet([Visible])),        GuiControl([ef_y_maxspeed],GuiGet([Text])),        [        --] ),'#13'    Cell(routine_row,12,routine_atom) :=  if( GuiControl([ef_z_maxspeed],GuiGet([Visible])),        GuiControl([ef_z_maxspeed],GuiGet([Text])),        [        --] ),'#13'    {--Deceleration--}'#13'    Cell(routine_row,13,routine_atom) :=  if( GuiControl([ef_x_deceleration],GuiGet([Visible])),    GuiControl([ef_x_deceleration],GuiGet([Text])),    [        --] ),'#13'    Cell(routine_row,14,routine_atom) :=  if( GuiControl([ef_y_deceleration],GuiGet([Visible])),    GuiControl([ef_y_deceleration],GuiGet([Text])),    [        --] ),'#13'    Cell(routine_row,15,routine_atom) :=  if( GuiControl([ef_z_deceleration],GuiGet([Visible])),    GuiControl([ef_z_deceleration],GuiGet([Text])),    [        --] ),'#13'    {--Endspeed--}'#13'    Cell(routine_row,16,routine_atom) := if( GuiControl([ef_endspeed],GuiGet([Visible])),        GuiControl([ef_endspeed],GuiGet([Text])),        [        --] ),'#13'    {--Time--}'#13'    Cell(routine_row,17,routine_atom) := if( GuiControl([ef_time],GuiGet([Visible])),            GuiControl([ef_time],GuiGet([Text])),            [        --] ),'#13'    {--Channel--}'#13'    Cell(routine_row,18,routine_atom) := if( GuiControl([ef_channel],GuiGet([Visible])),         GuiControl([ef_channel],GuiGet([Text])),         [        --] ),'#13'    {--Not used parameter--}'#13'    Cell(routine_row,19,routine_atom) := [        --],'#13'    {--Message--}'#13'    Cell(routine_row,20,routine_atom) := if( GuiControl([ef_getmessage],GuiGet([Visible])),      GuiControl([ef_getmessage],GuiGet([Text])),      [        --] ),'#13'    {--Trigger--}'#13'    Cell(routine_row,21,routine_atom) := if( GuiControl([ef_trigger],GuiGet([Visible])),         GuiControl([ef_trigger],GuiGet([ResultCode])),   [        --] ),'#13'    {--Deflection--}'#13'    Cell(routine_row,22,routine_atom) := if( GuiControl([ef_deflection],GuiGet([Visible])),      GuiControl([ef_deflection],GuiGet([Text])),      [        --] ),'#13'    {--Deflection speed--}'#13'    Cell(routine_row,23,routine_atom) := if( GuiControl([ef_deflectionspeed],GuiGet([Visible])), GuiControl([ef_deflectionspeed],GuiGet([Text])), [        --] ),'#13'    {--Rotation--}'#13'    Cell(routine_row,24,routine_atom) := if( GuiControl([ef_rotation],GuiGet([Visible])),        GuiControl([ef_rotation],GuiGet([Text])),        [        --] ),'#13'    {--Rotation speed--}'#13'    Cell(routine_row,25,routine_atom) := if( GuiControl([ef_rotationspeed],GuiGet([Visible])),   GuiControl([ef_rotationspeed],GuiGet([Text])),   [        --] ),'#13'       '#13'    {--Write parameters to temporary attributes (visible only)--}'#13'    '#13'    Att([alr_routine_command],GuiAtom) :=                GuiControl([st_command_text],GuiGet([Caption])),'#13'    if( GuiControl([ef_comment],GuiGet([Visible])),       Att([alr_routine_comment],GuiAtom) :=       GuiControl([ef_comment],GuiGet([Text])) ),'#13'    if( GuiControl([ef_x_destination],GuiGet([Visible])), Att([alr_routine_x_destination],GuiAtom) := GuiControl([ef_x_destination],GuiGet([Text])) ),'#13'    if( GuiControl([ef_y_destination],GuiGet([Visible])), Att([alr_routine_y_destination],GuiAtom) := GuiControl([ef_y_destination],GuiGet([Text])) ),'#13'    if( GuiControl([ef_z_destination],GuiGet([Visible])), Att([alr_routine_z_destination],GuiAtom) := GuiControl([ef_z_destination],GuiGet([Text])) ),'#13'    if( GuiControl([ef_x_acceleration],GuiGet([Visible])),  Att([alr_routine_x_acceleration],GuiAtom) :=  GuiControl([ef_x_acceleration],GuiGet([Text])) ),'#13'    if( GuiControl([ef_y_acceleration],GuiGet([Visible])),  Att([alr_routine_y_acceleration],GuiAtom) :=  GuiControl([ef_y_acceleration],GuiGet([Text])) ),'#13'    if( GuiControl([ef_z_acceleration],GuiGet([Visible])),  Att([alr_routine_z_acceleration],GuiAtom) :=  GuiControl([ef_z_acceleration],GuiGet([Text])) ),'#13'    if( GuiControl([ef_x_maxspeed],GuiGet([Visible])),      Att([alr_routine_x_maxspeed],GuiAtom) :=      GuiControl([ef_x_maxspeed],GuiGet([Text])) ),'#13'    if( GuiControl([ef_y_maxspeed],GuiGet([Visible])),      Att([alr_routine_y_maxspeed],GuiAtom) :=      GuiControl([ef_y_maxspeed],GuiGet([Text])) ),'#13'    if( GuiControl([ef_z_maxspeed],GuiGet([Visible])),      Att([alr_routine_z_maxspeed],GuiAtom) :=      GuiControl([ef_z_maxspeed],GuiGet([Text])) ),'#13'    if( GuiControl([ef_x_deceleration],GuiGet([Visible])),  Att([alr_routine_x_deceleration],GuiAtom) :=  GuiControl([ef_x_deceleration],GuiGet([Text])) ),'#13'    if( GuiControl([ef_y_deceleration],GuiGet([Visible])),  Att([alr_routine_y_deceleration],GuiAtom) :=  GuiControl([ef_y_deceleration],GuiGet([Text])) ),'#13'    if( GuiControl([ef_z_deceleration],GuiGet([Visible])),  Att([alr_routine_z_deceleration],GuiAtom) :=  GuiControl([ef_z_deceleration],GuiGet([Text])) ),'#13'    if( GuiControl([ef_endspeed],GuiGet([Visible])),      Att([alr_routine_endspeed],GuiAtom) :=      GuiControl([ef_endspeed],GuiGet([Text])) ),'#13'    if( GuiControl([ef_time],GuiGet([Visible])),          Att([alr_routine_time],GuiAtom) :=          GuiControl([ef_time],GuiGet([Text])) ),'#13'    if( GuiControl([ef_channel],GuiGet([Visible])),       Att([alr_routine_channel],GuiAtom) :=       GuiControl([ef_channel],GuiGet([Text])) ),'#13'    if( GuiControl([ef_getmessage],GuiGet([Visible])),    Att([alr_routine_getmessage],GuiAtom) :=    GuiControl([ef_getmessage],GuiGet([Text])) ),'#13'    if( GuiControl([ef_trigger],GuiGet([Visible])),       Att([alr_routine_trigger],GuiAtom) :=       GuiControl([ef_trigger],GuiGet([ResultCode])) ),'#13'    if( GuiControl([ef_deflection],GuiGet([Visible])),       Att([alr_routine_tool_deflection],GuiAtom) :=       GuiControl([ef_deflection],GuiGet([Text])) ),'#13'    if( GuiControl([ef_deflectionspeed],GuiGet([Visible])),  Att([alr_routine_tool_deflection_speed],GuiAtom) := GuiControl([ef_deflectionspeed],GuiGet([Text])) ),'#13'    if( GuiControl([ef_rotation],GuiGet([Visible])),         Att([alr_routine_tool_rotation],GuiAtom) :=         GuiControl([ef_rotation],GuiGet([Text])) ),'#13'    if( GuiControl([ef_rotationspeed],GuiGet([Visible])),    Att([alr_routine_tool_rotation_speed],GuiAtom) :=   GuiControl([ef_rotationspeed],GuiGet([Text])) ),'#13'    '#13'    {--Update index--}'#13'    Repeat(nRows(routine_atom),'#13'     Cell(Count,0,routine_atom) := Count'#13'    )'#13'   )'#13'  '#13'  ),'#13' '#13'  {--Select routine first--}'#13'  do('#13'   msg(Concat([No routine currently selected.],CR,[Select routine first.])),'#13'   GuiSelect([Advanced Linear Robot Add Command],[bt_select_routine]),'#13'   GuiRun([Click])'#13'  )'#13' '#13' )'#13' '#13')'#13))),
            EDControl(RadioGroup:
              Caption = str('Select command'),
              Height = 185,
              ItemIndex = 0,
              Items = str('Move to'#13#10'Stop'#13#10'Delay'#13#10'Load'#13#10'Unload'#13#10'Trigger'#13#10'Wait'#13#10'End'#13#10),
              Left = 8,
              Name = str('rg_select_command'),
              TabOrder = 1,
              Top = 8,
              Width = 115,
              Events(
                Change = str('do('#13' '#13' {--Update command text--}'#13' GuiControl([st_command_text],'#13'  GuiSet([Caption], '#13'   Case(GuiControl([rg_select_command], GuiGet([ItemIndex])),'#13'    [MoveTo],'#13'    [Stop],'#13'    [Delay],'#13'    [Load],'#13'    [Unload],'#13'    [Trigger],'#13'    [Wait],'#13'    [End]'#13'   )'#13'  )'#13' ),'#13' '#13' {--Default loadtime parameters or flexible edit--}'#13' if('#13'  Att([alr_default_loadtimes],GuiAtom),'#13'  do('#13'   {--Update loadtime and unloadtime only--}'#13'   Case(GuiControl([rg_select_command], GuiGet([ItemIndex])),'#13'    a,'#13'    a,'#13'    a,'#13'    GuiControl([ef_time],GuiSet([Text], TextAtt([alr_loadtime],GuiAtom))),'#13'    GuiControl([ef_time],GuiSet([Text], TextAtt([alr_unloadtime],GuiAtom))),'#13'    a,'#13'    a,'#13'    a'#13'   ),'#13'   Guicontrol([st_time], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_time], GuiSet([Enabled], False))'#13'  ),'#13'  do('#13'   Guicontrol([st_time], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_time], GuiSet([Enabled], True))'#13'  )'#13' ),'#13' '#13' {--Default speed parameters or flexible edit--}'#13' if('#13'  Att([avar_default_speeds],GuiAtom),'#13'  do('#13'   GuiControl([ef_x_acceleration],GuiSet([Text], TextAtt([alr_x_acceleration],GuiAtom))),'#13'   GuiControl([ef_y_acceleration],GuiSet([Text], TextAtt([alr_y_acceleration],GuiAtom))),'#13'   GuiControl([ef_z_acceleration],GuiSet([Text], TextAtt([alr_z_acceleration],GuiAtom))),'#13'   GuiControl([ef_x_maxspeed],GuiSet([Text], TextAtt([alr_x_maxspeed],GuiAtom))),'#13'   GuiControl([ef_y_maxspeed],GuiSet([Text], TextAtt([alr_y_maxspeed],GuiAtom))),'#13'   GuiControl([ef_z_maxspeed],GuiSet([Text], TextAtt([alr_z_maxspeed],GuiAtom))),'#13'   GuiControl([ef_x_deceleration],GuiSet([Text], TextAtt([alr_x_deceleration],GuiAtom))),'#13'   GuiControl([ef_y_deceleration],GuiSet([Text], TextAtt([alr_y_deceleration],GuiAtom))),'#13'   GuiControl([ef_z_deceleration],GuiSet([Text], TextAtt([alr_z_deceleration],GuiAtom))),'#13'   GuiControl([ef_endspeed],GuiSet([Text], TextAtt([alr_endspeed],GuiAtom))),'#13'   Guicontrol([st_acceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Enabled], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Enabled], False))'#13'  ),'#13'  do('#13'   Guicontrol([st_acceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([st_maxspeed], GuiSet([Enabled], True)),'#13'   Guicontrol([st_deceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([st_endspeed], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_endspeed], GuiSet([Enabled], True))'#13'  )'#13' ),'#13' '#13' {--Enable command variables according to selected command--}'#13' Case(GuiControl([rg_select_command], GuiGet([ItemIndex])),'#13'  {--Move to--}'#13'  do('#13'   Guicontrol([ef_comment], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], True)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], True)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], True)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], True)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], True)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], True)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], True)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], True)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], True)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], True)),'#13'   Guicontrol([ef_time], GuiSet([Visible], False)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], False)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], True)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], True))'#13'  ),'#13'  {--Stop--}'#13'  do('#13'   Guicontrol([ef_comment], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_time], GuiSet([Visible], False)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], False)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], False))'#13'  ),'#13'  {--Delay--}'#13'  do('#13'   {--Override default settings--}'#13'   Guicontrol([ef_time], GuiSet([Enabled], True)), '#13'   '#13'   Guicontrol([ef_comment], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_time], GuiSet([Visible], True)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], False)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], False))'#13'  ),'#13'  {--Load--}'#13'  do('#13'   Guicontrol([ef_comment], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_time], GuiSet([Visible], True)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], True)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], False))'#13'  ),'#13'  {--Unload--}'#13'  do('#13'   Guicontrol([ef_comment], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_time], GuiSet([Visible], True)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], True)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], False))'#13'  ),'#13'  {--Trigger--}'#13'  do('#13'   Guicontrol([ef_comment], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_time], GuiSet([Visible], False)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], False)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], True)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], False))'#13'  ),'#13'  {--Wait--}'#13'  do('#13'   Guicontrol([ef_comment], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_time], GuiSet([Visible], False)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], False)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], True)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], False))'#13'  ),'#13'  {--End--}'#13'  do('#13'   Guicontrol([ef_comment], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_time], GuiSet([Visible], False)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], False)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], False))'#13'  )'#13' ),'#13' '#13' {--Enable command describing text according to selected command--}'#13' Case(GuiControl([rg_select_command], GuiGet([ItemIndex])),'#13'  {--Move to--}'#13'  do('#13'   Guicontrol([st_comment], GuiSet([Visible], True)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], True)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], True)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], True)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], True)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], True)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], True)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], True)),'#13'   Guicontrol([st_time], GuiSet([Visible], False)),'#13'   Guicontrol([st_channel], GuiSet([Visible], False)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], True)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], True)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], True)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], True))'#13'  ),'#13'  {--Stop--}'#13'  do('#13'   Guicontrol([st_comment], GuiSet([Visible], True)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_time], GuiSet([Visible], False)),'#13'   Guicontrol([st_channel], GuiSet([Visible], False)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], False)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], False)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], False))'#13'  ),'#13'  {--Delay--}'#13'  do('#13'   {--Override default settings--}'#13'   Guicontrol([st_time], GuiSet([Enabled], True)), '#13'   '#13'   Guicontrol([st_comment], GuiSet([Visible], True)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_time], GuiSet([Visible], True)),'#13'   Guicontrol([st_channel], GuiSet([Visible], False)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], False)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], False)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], False))'#13'  ),'#13'  {--Load--}'#13'  do('#13'   Guicontrol([st_comment], GuiSet([Visible], True)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_time], GuiSet([Visible], True)),'#13'   Guicontrol([st_channel], GuiSet([Visible], True)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], False)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], False)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], False))'#13'  ),'#13'  {--Unload--}'#13'  do('#13'   Guicontrol([st_comment], GuiSet([Visible], True)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_time], GuiSet([Visible], True)),'#13'   Guicontrol([st_channel], GuiSet([Visible], True)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], False)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], False)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], False))'#13'  ),'#13'  {--Trigger--}'#13'  do('#13'   Guicontrol([st_comment], GuiSet([Visible], True)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_time], GuiSet([Visible], False)),'#13'   Guicontrol([st_channel], GuiSet([Visible], False)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], True)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], False)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], False)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], False))'#13'  ),'#13'  {--Wait--}'#13'  do('#13'   Guicontrol([st_comment], GuiSet([Visible], True)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_time], GuiSet([Visible], False)),'#13'   Guicontrol([st_channel], GuiSet([Visible], False)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], True)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], False)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], False)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], False))'#13'  ),'#13'  {--End--}'#13'  do('#13'   Guicontrol([st_comment], GuiSet([Visible], False)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_time], GuiSet([Visible], False)),'#13'   Guicontrol([st_channel], GuiSet([Visible], False)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], False)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], False)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], False))'#13'  )'#13' )'#13#13')'#13))),
            EDControl(Edit:
              Height = 21,
              Left = 264,
              Name = str('ef_y_destination'),
              TabOrder = 22,
              Text = str('ef_y_destination'),
              Top = 96),
            EDControl(Edit:
              Height = 21,
              Left = 264,
              Name = str('ef_time'),
              TabOrder = 23,
              Text = str('ef_time'),
              Top = 64),
            EDControl(Label:
              Caption = str('Destination (y):'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_y_destination'),
              Top = 104,
              Width = 70),
            EDControl(Label:
              Caption = str('Awaited message [string]:'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_getmessage'),
              Top = 72,
              Width = 120),
            EDControl(Edit:
              Height = 21,
              Left = 264,
              Name = str('ef_getmessage'),
              TabOrder = 24,
              Text = str('ef_getmessage'),
              Top = 64),
            EDControl(Label:
              Caption = str('Destination (x):'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_x_destination'),
              Top = 72,
              Width = 70),
            EDControl(Label:
              Caption = str('Time [s]:'),
              Color = -16777208,
              Height = 13,
              Left = 140,
              Name = str('st_time'),
              Top = 72,
              Width = 40),
            EDControl(Edit:
              Height = 21,
              Left = 264,
              Name = str('ef_x_destination'),
              TabOrder = 2,
              Text = str('ef_x_destination'),
              Top = 64),
            EDControl(Edit:
              Height = 21,
              Left = 304,
              Name = str('ef_y_acceleration'),
              TabOrder = 25,
              Text = str('ef_y_acceleration'),
              Top = 160,
              Width = 33),
            EDControl(Edit:
              Height = 21,
              Left = 352,
              Name = str('ef_z_acceleration'),
              TabOrder = 27,
              Text = str('ef_z_acceleration'),
              Top = 160,
              Width = 33),
            EDControl(Edit:
              Height = 21,
              Left = 304,
              Name = str('ef_y_maxspeed'),
              TabOrder = 28,
              Text = str('ef_y_maxspeed'),
              Top = 192,
              Width = 33),
            EDControl(Edit:
              Height = 21,
              Left = 352,
              Name = str('ef_z_maxspeed'),
              TabOrder = 29,
              Text = str('ef_z_maxspeed'),
              Top = 192,
              Width = 33),
            EDControl(Edit:
              Height = 21,
              Left = 304,
              Name = str('ef_y_deceleration'),
              TabOrder = 26,
              Text = str('ef_y_deceleration'),
              Top = 224,
              Width = 33),
            EDControl(Edit:
              Height = 21,
              Left = 352,
              Name = str('ef_z_deceleration'),
              TabOrder = 9,
              Text = str('ef_z_deceleration'),
              Top = 224,
              Width = 33))),
        EDControl(SinglePage:
          Caption = str('Teach in'),
          Name = str('SinglePage3'),
          PageIndex = 3,
          Controls(
            EDControl(GroupBox:
              Caption = str('Main arm'),
              Height = 169,
              Left = 192,
              Name = str('gb_teach_main_arm'),
              TabOrder = 2,
              Top = 68,
              Width = 195,
              Controls(
                EDControl(Button:
                  Caption = str('y +'),
                  Height = 33,
                  Left = 80,
                  Name = str('bt_y_pos'),
                  TabOrder = 2,
                  Top = 120,
                  Width = 35,
                  Events(
                    Click = str('yLoc(First(First(GuiAtom))) := yLoc(First(First(GuiAtom))) + Round(Value(GuiControl([ef_coords_step],GuiGet([Text]))), 3)'#13))),
                EDControl(Button:
                  Caption = str('x +'),
                  Height = 33,
                  Left = 134,
                  Name = str('bt_x_pos'),
                  TabOrder = 5,
                  Top = 72,
                  Width = 35,
                  Events(
                    Click = str('xLoc(First(GuiAtom)) := xLoc(First(GuiAtom)) + Round(Value(GuiControl([ef_coords_step],GuiGet([Text]))), 3)'#13))),
                EDControl(Button:
                  Caption = str('z -'),
                  Height = 17,
                  Left = 80,
                  Name = str('bt_x_neg2'),
                  TabOrder = 4,
                  Top = 88,
                  Width = 35,
                  Events(
                    Click = str('zLoc(First(First(First(GuiAtom)))) := zLoc(First(First(First(GuiAtom)))) - Round(Value(GuiControl([ef_coords_step],GuiGet([Text]))), 3)'#13))),
                EDControl(Button:
                  Caption = str('z +'),
                  Height = 17,
                  Left = 80,
                  Name = str('bt_z_pos'),
                  TabOrder = 6,
                  Top = 72,
                  Width = 35,
                  Events(
                    Click = str('zLoc(First(First(First(GuiAtom)))) := zLoc(First(First(First(GuiAtom)))) + Round(Value(GuiControl([ef_coords_step],GuiGet([Text]))), 3)'#13))),
                EDControl(Button:
                  Caption = str('y -'),
                  Height = 33,
                  Left = 80,
                  Name = str('bt_y_neg'),
                  TabOrder = 1,
                  Top = 24,
                  Width = 35,
                  Events(
                    Click = str('yLoc(First(First(GuiAtom))) := yLoc(First(First(GuiAtom))) - Round(Value(GuiControl([ef_coords_step],GuiGet([Text]))), 3)'#13))),
                EDControl(Button:
                  Caption = str('x -'),
                  Height = 33,
                  Left = 24,
                  Name = str('bt_x_neg'),
                  TabOrder = 3,
                  Top = 72,
                  Width = 35,
                  Events(
                    Click = str('xLoc(First(GuiAtom)) := xLoc(First(GuiAtom)) - Round(Value(GuiControl([ef_coords_step],GuiGet([Text]))), 3)'#13))))),
            EDControl(GroupBox:
              Caption = str('Tool arm'),
              Height = 65,
              Left = 0,
              Name = str('gb_teach_tool_arm'),
              TabOrder = 4,
              Top = 244,
              Visible = False,
              Width = 195,
              Controls(
                EDControl(Button:
                  Caption = str('Deflection +'),
                  Left = 104,
                  Name = str('bt_deflection_pos'),
                  TabOrder = 2,
                  Top = 24,
                  Events(
                    Click = str('Att([alr_tool_deflection],GuiAtom) := Att([alr_tool_deflection],GuiAtom) + Round(Value(GuiControl([ef_angles_step],GuiGet([Text]))), 3)'#13))),
                EDControl(Button:
                  Caption = str('Deflection -'),
                  Left = 16,
                  Name = str('bt_deflection_neg'),
                  TabOrder = 1,
                  Top = 24,
                  Events(
                    Click = str('Att([alr_tool_deflection],GuiAtom) := Att([alr_tool_deflection],GuiAtom) - Round(Value(GuiControl([ef_angles_step],GuiGet([Text]))), 3)'#13))))),
            EDControl(GroupBox:
              Caption = str('Tool'),
              Height = 65,
              Left = 192,
              Name = str('gb_teach_tool'),
              TabOrder = 5,
              Top = 244,
              Width = 195,
              Controls(
                EDControl(Button:
                  Caption = str('Rotation +'),
                  Left = 104,
                  Name = str('bt_rotation_pos'),
                  TabOrder = 2,
                  Top = 24,
                  Events(
                    Click = str('Att([alr_tool_rotation],GuiAtom) := Att([alr_tool_rotation],GuiAtom) + Round(Value(GuiControl([ef_angles_step],GuiGet([Text]))), 3)'#13))),
                EDControl(Button:
                  Caption = str('Rotation -'),
                  Left = 16,
                  Name = str('bt_rotation_neg'),
                  TabOrder = 1,
                  Top = 24,
                  Events(
                    Click = str('Att([alr_tool_rotation],GuiAtom) := Att([alr_tool_rotation],GuiAtom) - Round(Value(GuiControl([ef_angles_step],GuiGet([Text]))), 3)'#13))))),
            EDControl(Label:
              Caption = str('Coordinates step size [m/click]:'),
              Color = -16777208,
              Height = 13,
              Left = 12,
              Name = str('st_grid_size'),
              Top = 16,
              Width = 147),
            EDControl(Label:
              Caption = str('Angles step size [°/click]:'),
              Color = -16777208,
              Height = 13,
              Left = 12,
              Name = str('st_angle_size'),
              Top = 48,
              Width = 119),
            EDControl(Edit:
              Height = 21,
              Left = 192,
              Name = str('ef_angles_step'),
              TabOrder = 3,
              Text = str('ef_angles_step'),
              Top = 40,
              Width = 195),
            EDControl(Edit:
              Height = 21,
              Left = 192,
              Name = str('ef_coords_step'),
              TabOrder = 1,
              Text = str('ef_coords_step'),
              Top = 8,
              Width = 195),
            EDControl(Button:
              Caption = str('Teach in'),
              Left = 192,
              Name = str('bt_teach_in'),
              TabOrder = 6,
              Top = 318,
              Width = 195,
              Events(
                Click = str('do('#13' GuiControl([bt_get_position]),'#13' GuiRun([Click]),'#13' GuiControl([bt_apply_command]),'#13' GuiRun([Click])'#13')'#13)))),
          Events(
            Enter = str('{--Move command for teaching mode--}'#13'GuiControl([rg_select_command], GuiSet([ItemIndex], 1))'#13),
            Exit = str('do('#13' GuiControl([bt_get_position]),'#13' GuiRun([Click])'#13')'#13))),
        EDControl(SinglePage:
          Caption = str('Define relative parameters'),
          Name = str('SinglePage4'),
          PageIndex = 4,
          Controls(
            EDControl(GroupBox:
              Caption = str('Relative destinations'),
              Height = 401,
              Left = 8,
              Name = str('gb_pickselectionrule2'),
              TabOrder = 1,
              Top = 8,
              Width = 377,
              Controls(
                EDControl(SmartEdit:
                  Left = 170,
                  Lines = str(''),
                  Name = str('se_routine_relative_dest_x'),
                  String = str('{.~1|.}~1'),
                  TabOrder = 1,
                  Top = 33,
                  Width = 195),
                EDControl(SmartEdit:
                  Left = 170,
                  Lines = str(''),
                  Name = str('se_routine_relative_dest_y'),
                  String = str('{.~1|.}~1'),
                  TabOrder = 2,
                  Top = 65,
                  Width = 195),
                EDControl(SmartEdit:
                  Left = 170,
                  Lines = str(''),
                  Name = str('se_routine_relative_dest_z'),
                  String = str('{.~1|.}~1'),
                  TabOrder = 3,
                  Top = 97,
                  Width = 195),
                EDControl(SmartEdit:
                  Left = 170,
                  Lines = str(''),
                  Name = str('se_routine_relative_tool_rotation'),
                  String = str('{.~1|.}~1'),
                  TabOrder = 4,
                  Top = 129,
                  Width = 195),
                EDControl(Label:
                  Caption = str('Relative destination (x):'),
                  Color = -16777208,
                  Height = 13,
                  Left = 12,
                  Name = str('st_routine_relative_dest_x'),
                  Top = 40,
                  Width = 110),
                EDControl(Label:
                  Caption = str('Relative destination (y):'),
                  Color = -16777208,
                  Height = 13,
                  Left = 12,
                  Name = str('st_routine_relative_dest_y'),
                  Top = 72,
                  Width = 110),
                EDControl(Label:
                  Caption = str('Relative destination (z):'),
                  Color = -16777208,
                  Height = 13,
                  Left = 12,
                  Name = str('st_routine_relative_dest_z'),
                  Top = 104,
                  Width = 110),
                EDControl(Label:
                  Caption = str('Relative tool rotation [°]:'),
                  Color = -16777208,
                  Height = 13,
                  Left = 12,
                  Name = str('st_routine_relative_tool_rotation'),
                  Top = 136,
                  Width = 113))))))),
    EDControl(Panel:
      Align = Bottom,
      Anchors = set(Left,Right,Bottom),
      BevelOuter = None,
      Caption = str(''),
      Height = 40,
      Left = 0,
      Name = str('Panel1'),
      TabOrder = 2,
      Top = 446,
      Width = 403,
      Controls(
        EDControl(Button:
          Cancel = True,
          Caption = str('&Cancel'),
          Left = 235,
          Name = str('btnCancel'),
          TabOrder = 4,
          Top = 8,
          Events(
            Click = str('Do('#13' {--Close routine table--}'#13' if('#13'  {--Fail safe--}'#13'  and('#13'   {--Pointer of active routine--}'#13'   Att([avar_active_routine],GuiAtom) > 0,'#13'   {--Routine exists--}'#13'   AtomExists(vtp(Att([avar_active_routine],GuiAtom)), Rank(2,GuiAtom))'#13'  ),'#13'  {--Close--}'#13'  Close(TableWindow(vtp(Att([avar_active_routine],GuiAtom))))'#13' ),'#13#13' GuiDestroy,'#13' GuiUnregister([Advanced Vertical Articulated Robot Edit Routines])'#13')'#13))),
        EDControl(Button:
          Caption = str('&Ok'),
          Default = True,
          Left = 153,
          Name = str('btnOk'),
          TabOrder = 2,
          Top = 8,
          Events(
            Click = str('Do('#13' GuiControl([btnApply]),'#13' GuiRun([Click]),'#13' '#13' {--Close routine table--}'#13' if('#13'  {--Fail safe--}'#13'  and('#13'   {--Pointer of active routine--}'#13'   Att([avar_active_routine],GuiAtom) > 0,'#13'   {--Routine exists--}'#13'   AtomExists(vtp(Att([avar_active_routine],GuiAtom)), Rank(2,GuiAtom))'#13'  ),'#13'  {--Close--}'#13'  Close(TableWindow(vtp(Att([avar_active_routine],GuiAtom))))'#13' ),'#13' '#13' GuiDestroy,'#13' GuiUnregister([Advanced Vertical Articulated Robot Edit Routines])'#13')'#13))),
        EDControl(Button:
          Caption = str('&Help'),
          Left = 8,
          Name = str('btnHelp'),
          TabOrder = 1,
          Top = 8,
          Events(
            Click = str('Help(PDir([HELP\ED Help.hlp]), [Advanced Vertical Articulated Robot Edit Routines])'#13))),
        EDControl(Button:
          Caption = str('&Apply'),
          Left = 317,
          Name = str('btnApply'),
          TabOrder = 3,
          Top = 8,
          Events(
            Click = str('Do('#13#13' {--Page 3--}'#13' '#13' {--Coordinates stepsize--}'#13' Att([alr_coords_step_size],GuiAtom) := Round(Value(GuiControl([ef_coords_step],GuiGet([Text]))), 3),'#13' '#13' {--Angles stepsize--}'#13' Att([alr_angles_step_size],GuiAtom) := Round(Value(GuiControl([ef_angles_step],GuiGet([Text]))), 3),'#13' '#13' {--Page 1--}'#13' '#13' SetExprAtt('#13'  [PickSelectionRule],'#13'  GuiControl([se_pickselectionrule],GuiGet([String])),'#13'  vtp(Att([alr_active_routine],GuiAtom))'#13' ),'#13' '#13' SetExprAtt('#13'  [PlaceSelectionRule],'#13'  GuiControl([se_placeselectionrule],GuiGet([String])),'#13'  vtp(Att([alr_active_routine],GuiAtom))'#13' ),'#13' '#13' {--Page 4--}'#13' '#13' SetExprAtt('#13'  [Routine_relative_dest_x],'#13'  GuiControl([se_routine_relative_dest_x],GuiGet([String])),'#13'  vtp(Att([alr_active_routine],GuiAtom))'#13' ), '#13' '#13' SetExprAtt('#13'  [Routine_relative_dest_y],'#13'  GuiControl([se_routine_relative_dest_y],GuiGet([String])),'#13'  vtp(Att([alr_active_routine],GuiAtom))'#13' ), '#13' '#13' SetExprAtt('#13'  [Routine_relative_dest_z],'#13'  GuiControl([se_routine_relative_dest_z],GuiGet([String])),'#13'  vtp(Att([alr_active_routine],GuiAtom))'#13' ),'#13' '#13' SetExprAtt('#13'  [Routine_relative_tool_rotation],'#13'  GuiControl([se_routine_relative_tool_rotation],GuiGet([String])),'#13'  vtp(Att([alr_active_routine],GuiAtom))'#13' )'#13#13')'#13)))))),
  Events(
    Show = str('do('#13' '#13' {--Open table of selected routine--}'#13' EditTable(vtp(Att([alr_active_routine],GuiAtom))),'#13' '#13' {--Page 1 : Define selection rules--}'#13#13' {--Pick routine selection rule--}'#13' repeat(21,'#13'  GuiControl([se_pickselectionrule],GuiList([Lines],[Add], Advanced_Linear_Robot_getRoutinePickSelectionRule(Count)))'#13' ),'#13' GuiControl([se_pickselectionrule],GuiSet([String],textatt([PickSelectionRule],vtp(Att([alr_active_routine],GuiAtom))))), '#13#13' {--Place routine selection rule--}'#13' repeat(21,'#13'  GuiControl([se_placeselectionrule],GuiList([Lines],[Add], Advanced_Linear_Robot_getRoutinePlaceSelectionRule(Count)))'#13' ),'#13' GuiControl([se_placeselectionrule],GuiSet([String],textatt([PlaceSelectionRule],vtp(Att([alr_active_routine],GuiAtom))))), '#13' '#13' {--Page 2 : Edit command--}'#13#13' {--Select command--}'#13' GuiControl([rg_select_command], GuiSet([ItemIndex], Att([alr_routine_command_flag], GuiAtom))),'#13' '#13' {--Update command text--}'#13' GuiControl([st_command_text],'#13'  GuiSet([Caption], '#13'   Case(GuiControl([rg_select_command], GuiGet([ItemIndex])),'#13'    [MoveTo],'#13'    [Stop],'#13'    [Delay],'#13'    [Load],'#13'    [Unload],'#13'    [Trigger],'#13'    [Wait],'#13'    [End]'#13'   )'#13'  )'#13' ),'#13' '#13' {--Update variables--}'#13' GuiControl([ef_comment],GuiSet([Text], TextAtt([alr_routine_comment],GuiAtom))),'#13' GuiControl([ef_x_destination],GuiSet([Text], TextAtt([alr_routine_x_destination],GuiAtom))),'#13' GuiControl([ef_y_destination],GuiSet([Text], TextAtt([alr_routine_y_destination],GuiAtom))),'#13' GuiControl([ef_z_destination],GuiSet([Text], TextAtt([alr_routine_z_destination],GuiAtom))),'#13' GuiControl([ef_x_acceleration],GuiSet([Text], TextAtt([alr_routine_x_acceleration],GuiAtom))),'#13' GuiControl([ef_y_acceleration],GuiSet([Text], TextAtt([alr_routine_y_acceleration],GuiAtom))),'#13' GuiControl([ef_z_acceleration],GuiSet([Text], TextAtt([alr_routine_z_acceleration],GuiAtom))),'#13' GuiControl([ef_x_maxspeed],GuiSet([Text], TextAtt([alr_routine_x_maxspeed],GuiAtom))),'#13' GuiControl([ef_y_maxspeed],GuiSet([Text], TextAtt([alr_routine_y_maxspeed],GuiAtom))),'#13' GuiControl([ef_z_maxspeed],GuiSet([Text], TextAtt([alr_routine_z_maxspeed],GuiAtom))),'#13' GuiControl([ef_x_deceleration],GuiSet([Text], TextAtt([alr_routine_x_deceleration],GuiAtom))),'#13' GuiControl([ef_y_deceleration],GuiSet([Text], TextAtt([alr_routine_y_deceleration],GuiAtom))),'#13' GuiControl([ef_z_deceleration],GuiSet([Text], TextAtt([alr_routine_z_deceleration],GuiAtom))),'#13' GuiControl([ef_endspeed],GuiSet([Text], TextAtt([alr_routine_endspeed],GuiAtom))),'#13' GuiControl([ef_time],GuiSet([Text], TextAtt([alr_routine_time],GuiAtom))),'#13' GuiControl([ef_channel],GuiSet([Text], TextAtt([alr_routine_channel],GuiAtom))),'#13' GuiControl([ef_getmessage],GuiSet([Text], TextAtt([alr_routine_getmessage],GuiAtom))),'#13' GuiControl([ef_trigger],GuiSet([CodeItems], concat(char(1),[objectstart],char(1),[code:],TextAtt([alr_routine_trigger],GuiAtom),char(1),[objectend], getTriggerEnterExit))),'#13' GuiControl([ef_trigger],GuiSet([ItemIndex], 1)),  '#13' {GuiControl([ef_trigger],GuiSet([Text], TextAtt([alr_routine_trigger],GuiAtom))),}'#13' GuiControl([ef_deflection],GuiSet([Text], TextAtt([alr_routine_tool_deflection],GuiAtom))), '#13' GuiControl([ef_deflectionspeed],GuiSet([Text], TextAtt([alr_routine_tool_deflection_speed],GuiAtom))), '#13' GuiControl([ef_rotation],GuiSet([Text], TextAtt([alr_routine_tool_rotation],GuiAtom))), '#13' GuiControl([ef_rotationspeed],GuiSet([Text], TextAtt([alr_routine_tool_rotation_speed],GuiAtom))), '#13'  '#13' {--Default loadtime parameters or flexible edit--}'#13' if('#13'  Att([alr_default_loadtimes],GuiAtom),'#13'  do('#13'   {--Update loadtime and unloadtime only--}'#13'   Case(GuiControl([rg_select_command], GuiGet([ItemIndex])),'#13'    a,'#13'    a,'#13'    a,'#13'    GuiControl([ef_time],GuiSet([Text], TextAtt([alr_loadtime],GuiAtom))),'#13'    GuiControl([ef_time],GuiSet([Text], TextAtt([alr_unloadtime],GuiAtom))),'#13'    a,'#13'    a,'#13'    a'#13'   ),'#13'   Guicontrol([st_time], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_time], GuiSet([Enabled], False))'#13'  ),'#13'  do('#13'   Guicontrol([st_time], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_time], GuiSet([Enabled], True))'#13'  )'#13' ),'#13' '#13' {--Default speed parameters or flexible edit--}'#13' if('#13'  Att([alr_default_speeds],GuiAtom),'#13'  do('#13'   GuiControl([ef_x_acceleration],GuiSet([Text], TextAtt([alr_x_acceleration],GuiAtom))),'#13'   GuiControl([ef_y_acceleration],GuiSet([Text], TextAtt([alr_y_acceleration],GuiAtom))),'#13'   GuiControl([ef_z_acceleration],GuiSet([Text], TextAtt([alr_z_acceleration],GuiAtom))),'#13'   GuiControl([ef_x_maxspeed],GuiSet([Text], TextAtt([alr_x_maxspeed],GuiAtom))),'#13'   GuiControl([ef_y_maxspeed],GuiSet([Text], TextAtt([alr_y_maxspeed],GuiAtom))),'#13'   GuiControl([ef_z_maxspeed],GuiSet([Text], TextAtt([alr_z_maxspeed],GuiAtom))),'#13'   GuiControl([ef_x_deceleration],GuiSet([Text], TextAtt([alr_x_deceleration],GuiAtom))),'#13'   GuiControl([ef_y_deceleration],GuiSet([Text], TextAtt([alr_y_deceleration],GuiAtom))),'#13'   GuiControl([ef_z_deceleration],GuiSet([Text], TextAtt([alr_z_deceleration],GuiAtom))),'#13'   GuiControl([ef_endspeed],GuiSet([Text], TextAtt([alr_endspeed],GuiAtom))),'#13'   Guicontrol([st_acceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Enabled], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Enabled], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Enabled], False))'#13'  ),'#13'  do('#13'   Guicontrol([st_acceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([st_maxspeed], GuiSet([Enabled], True)),'#13'   Guicontrol([st_deceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([st_endspeed], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Enabled], True)),'#13'   Guicontrol([ef_endspeed], GuiSet([Enabled], True))'#13'  )'#13' ),'#13' '#13' {--Enable command variables according to selected command--}'#13' Case(GuiControl([rg_select_command], GuiGet([ItemIndex])),'#13'  {--Move to--}'#13'  do('#13'   Guicontrol([ef_comment], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], True)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], True)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], True)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], True)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], True)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], True)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], True)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], True)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], True)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], True)),'#13'   Guicontrol([ef_time], GuiSet([Visible], False)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], False)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], True)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], True))'#13'  ),'#13'  {--Stop--}'#13'  do('#13'   Guicontrol([ef_comment], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_time], GuiSet([Visible], False)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], False)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], False))'#13'  ),'#13'  {--Delay--}'#13'  do('#13'   {--Override default settings--}'#13'   Guicontrol([ef_time], GuiSet([Enabled], True)), '#13'  '#13'   Guicontrol([ef_comment], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_time], GuiSet([Visible], True)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], False)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], False))'#13'  ),'#13'  {--Load--}'#13'  do('#13'   Guicontrol([ef_comment], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_time], GuiSet([Visible], True)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], True)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], False))'#13'  ),'#13'  {--Unload--}'#13'  do('#13'   Guicontrol([ef_comment], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_time], GuiSet([Visible], True)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], True)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], False))'#13'  ),'#13'  {--Trigger--}'#13'  do('#13'   Guicontrol([ef_comment], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_time], GuiSet([Visible], False)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], False)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], True)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], False))'#13'  ),'#13'  {--Wait--}'#13'  do('#13'   Guicontrol([ef_comment], GuiSet([Visible], True)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_time], GuiSet([Visible], False)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], False)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], True)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], False))'#13'  ),'#13'  {--End--}'#13'  do('#13'   Guicontrol([ef_comment], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_x_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_y_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_z_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([ef_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_time], GuiSet([Visible], False)),'#13'   Guicontrol([ef_channel], GuiSet([Visible], False)),'#13'   Guicontrol([ef_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([ef_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([ef_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([ef_rotationspeed], GuiSet([Visible], False))'#13'  )'#13' ),'#13' '#13' {--Enable command describing text according to selected command--}'#13' Case(GuiControl([rg_select_command], GuiGet([ItemIndex])),'#13'  {--Move to--}'#13'  do('#13'   Guicontrol([st_comment], GuiSet([Visible], True)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], True)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], True)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], True)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], True)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], True)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], True)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], True)),'#13'   Guicontrol([st_time], GuiSet([Visible], False)),'#13'   Guicontrol([st_channel], GuiSet([Visible], False)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], True)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], True)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], True)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], True))'#13'  ),'#13'  {--Stop--}'#13'  do('#13'   Guicontrol([st_comment], GuiSet([Visible], True)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_time], GuiSet([Visible], False)),'#13'   Guicontrol([st_channel], GuiSet([Visible], False)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], False)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], False)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], False))'#13'  ),'#13'  {--Delay--}'#13'  do('#13'   {--Override default settings--}'#13'   Guicontrol([st_time], GuiSet([Enabled], True)),'#13'   '#13'   Guicontrol([st_comment], GuiSet([Visible], True)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_time], GuiSet([Visible], True)),'#13'   Guicontrol([st_channel], GuiSet([Visible], False)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], False)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], False)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], False))'#13'  ),'#13'  {--Load--}'#13'  do('#13'   Guicontrol([st_comment], GuiSet([Visible], True)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_time], GuiSet([Visible], True)),'#13'   Guicontrol([st_channel], GuiSet([Visible], True)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], False)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], False)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], False))'#13'  ),'#13'  {--Unload--}'#13'  do('#13'   Guicontrol([st_comment], GuiSet([Visible], True)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_time], GuiSet([Visible], True)),'#13'   Guicontrol([st_channel], GuiSet([Visible], True)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], False)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], False)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], False))'#13'  ),'#13'  {--Trigger--}'#13'  do('#13'   Guicontrol([st_comment], GuiSet([Visible], True)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_time], GuiSet([Visible], False)),'#13'   Guicontrol([st_channel], GuiSet([Visible], False)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], True)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], False)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], False)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], False))'#13'  ),'#13'  {--Wait--}'#13'  do('#13'   Guicontrol([st_comment], GuiSet([Visible], True)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_time], GuiSet([Visible], False)),'#13'   Guicontrol([st_channel], GuiSet([Visible], False)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], True)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], False)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], False)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], False))'#13'  ),'#13'  {--End--}'#13'  do('#13'   Guicontrol([st_comment], GuiSet([Visible], False)),'#13'   Guicontrol([st_x_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_y_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_z_destination], GuiSet([Visible], False)),'#13'   Guicontrol([st_acceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_maxspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_deceleration], GuiSet([Visible], False)),'#13'   Guicontrol([st_endspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_time], GuiSet([Visible], False)),'#13'   Guicontrol([st_channel], GuiSet([Visible], False)),'#13'   Guicontrol([st_getmessage], GuiSet([Visible], False)),'#13'   Guicontrol([st_trigger], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflection], GuiSet([Visible], False)),'#13'   Guicontrol([st_deflectionspeed], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotation], GuiSet([Visible], False)),'#13'   Guicontrol([st_rotationspeed], GuiSet([Visible], False)),'#13'   '#13'   Guicontrol([bt_get_position], GuiSet([Visible], False)),'#13'   Guicontrol([bt_set_position], GuiSet([Visible], False))'#13'  )'#13' ),'#13' '#13' {--Page 3 : Teach in--}'#13' '#13' {--Coordinates stepsize--}'#13' GuiControl([ef_coords_step],GuiSet([Text], TextAtt([alr_coords_step_size],GuiAtom))),'#13#13' {--Angles stepsize--}'#13' GuiControl([ef_angles_step],GuiSet([Text], TextAtt([alr_angles_step_size],GuiAtom))),'#13' '#13' {--Page 4 : Define relative destinations--}'#13#13' {--Relative destinations x--}'#13' repeat(5,'#13'  GuiControl([se_routine_relative_dest_x],GuiList([Lines],[Add], Advanced_Linear_Robot_getRoutineRelativeDestination(Count)))'#13' ),'#13' GuiControl([se_routine_relative_dest_x],GuiSet([String],textatt([Routine_relative_dest_x],vtp(Att([alr_active_routine],GuiAtom))))), '#13#13' {--Relative destinations y--}'#13' repeat(5,'#13'  GuiControl([se_routine_relative_dest_y],GuiList([Lines],[Add], Advanced_Linear_Robot_getRoutineRelativeDestination(Count)))'#13' ),'#13' GuiControl([se_routine_relative_dest_y],GuiSet([String],textatt([Routine_relative_dest_y],vtp(Att([alr_active_routine],GuiAtom))))), '#13' '#13' {--Relative destinations z--}'#13' repeat(5,'#13'  GuiControl([se_routine_relative_dest_z],GuiList([Lines],[Add], Advanced_Linear_Robot_getRoutineRelativeDestination(Count)))'#13' ),'#13' GuiControl([se_routine_relative_dest_z],GuiSet([String],textatt([Routine_relative_dest_z],vtp(Att([alr_active_routine],GuiAtom))))), '#13#13' {--Relative tool rotation--}'#13' repeat(5,'#13'  GuiControl([se_routine_relative_tool_rotation],GuiList([Lines],[Add], Advanced_Linear_Robot_getRoutineRelativeDestination(Count)))'#13' ),'#13' GuiControl([se_routine_relative_tool_rotation],GuiSet([String],textatt([Routine_relative_tool_rotation],vtp(Att([alr_active_routine],GuiAtom))))), '#13' '#13' { *** position the form *** }  '#13' if(GuiControl([Advanced Linear Robot Edit Routines], GuiGet([Top])) < 0, GuiControl([Advanced Linear Robot Edit Routines], GuiSet([Top], 0))),'#13' if(GuiControl([Advanced Linear Robot Edit Routines], GuiGet([Left])) < 0, GuiControl([Advanced Linear Robot Edit Routines], GuiSet([Left], 0))),'#13#13' if(GuiControl([Advanced Linear Robot Edit Routines], GuiGet([Top])) > ScreenHeight - GuiControl([Advanced Linear Robot Edit Routines], GuiGet([Height])), GuiControl([Advanced Linear Robot Edit Routines], GuiSet([Top], ScreenHeight - 50 - GuiControl([Advanced Linear Robot Edit Routines], GuiGet([Height]))))),'#13' if(GuiControl([Advanced Linear Robot Edit Routines], GuiGet([Left])) > ScreenWidth - GuiControl([Advanced Linear Robot Edit Routines], GuiGet([Width])), GuiControl([Advanced Linear Robot Edit Routines], GuiSet([Left], ScreenWidth - 10 - GuiControl([Advanced Linear Robot Edit Routines], GuiGet([Width])))))'#13' '#13')'#13)))


